# hive命令的几种执行方式_20201102

1. hue

2. 2.CLI(控制台)

   hive

​		-e  "show databases;" 

​		-f    /srv/xxxx.sql

​		beeline 远程连接

​	

3.新建一个sql文件





--创建hive表脚本

use xxxx;

drop table dwd_labor_company_injurys_di ;

create table dwd_labor_company_injurys_di as
select  b.id month_id,d.id area_id,c.crop_id company_id,a.AAE078 is_pay,a.AAE140 plant_type,a.AAB119 is_ginseng_num
from ods_si_ad21_di a 
left join dim_month b on a.AAE002=b.month_name
left join dim_crop_di c on a.AAB001=c.crop_id
left join dim_areainfo d on c.area=d.AREA_CODE
where a.AAE140='工伤险'



4.新建一个sh文件

```sql
#!/bin/bash

hive -f  /srv/xxx.sql
```



5.配置datax shell任务

![image-20201102202148318](C:\Users\bahsk\AppData\Roaming\Typora\typora-user-images\image-20201102202148318.png)

命令:

```shell
ssh 192.168.41.244 "/srv/hive_script/dwd_labor_company_injurys_di.sh >> /srv/hive_script/dwd_labor_company_injurys_di.log"
```

